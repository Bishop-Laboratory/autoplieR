<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="autoplieR">
<title>Embedding and analyzing Omics data with autoplieR • autoplieR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../deps/_Kantumruy%20Pro-0.4.1/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Embedding and analyzing Omics data with autoplieR">
<meta property="og:description" content="autoplieR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">autoplieR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/autoplieR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Bishop-Laboratory/autoplieR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Embedding and analyzing Omics data with autoplieR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Bishop-Laboratory/autoplieR/blob/HEAD/vignettes/autoplieR.Rmd" class="external-link"><code>vignettes/autoplieR.Rmd</code></a></small>
      <div class="d-none name"><code>autoplieR.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>Steps to embed Omics data into a latent space representation are
shown below. autoplieR takes in data frames containing gene expression
data and corresponding pathways data called <code>xtrain</code> and
<code>pwy</code>, respectively. For ease of analysis, be sure that row
names are appropriately labeled. <code>lv</code> should have a factored
column with the chosen latent variables.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autoPLIER.html">autoPLIER</a></span><span class="op">(</span>n_components <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autoPLIER.fit.html">autoPLIER.fit</a></span><span class="op">(</span><span class="va">mod</span>, x_train <span class="op">=</span> <span class="va">xtrain</span>, pathways <span class="op">=</span> <span class="va">pwy</span>, verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">trans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autoPLIER.transform.html">autoPLIER.transform</a></span><span class="op">(</span><span class="va">mod</span>, x_predict <span class="op">=</span> <span class="va">xtrain</span>, pathways <span class="op">=</span> <span class="va">pwy</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get pathways most associated with the LVs</span></span>
<span><span class="va">top_pwys</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autoPLIER.get_top_pathways.html">autoPLIER.get_top_pathways</a></span><span class="op">(</span><span class="va">mod</span>, LVs <span class="op">=</span> <span class="va">lv</span>, n_pathways <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get LVs most associated with a chosen pathway</span></span>
<span><span class="va">top_LVs_pwys</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autoPLIER.get_top_pathway_LVs.html">autoPLIER.get_top_pathway_LVs</a></span><span class="op">(</span><span class="va">mod</span>, pathway <span class="op">=</span> <span class="fl">2</span>, n_LVs <span class="op">=</span> <span class="fl">5L</span><span class="op">)</span> <span class="co"># pathway arg goes by row name</span></span>
<span>                                                                            <span class="co"># from pathways dataset</span></span>
<span></span>
<span><span class="va">top_LVs_pwys</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autoPLIER.get_top_pathway_LVs.html">autoPLIER.get_top_pathway_LVs</a></span><span class="op">(</span><span class="va">mod</span>, pathway <span class="op">=</span> <span class="st">"BIOCARTA_LYM_PATHWAY"</span>, n_LVs <span class="op">=</span> <span class="fl">5L</span><span class="op">)</span> <span class="co"># if row name is named by pathway</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>AutoplieR can be installed from github.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://remotes.r-lib.org" class="external-link">remotes</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"Bishop-Laboratory/autoplieR"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="method">Method<a class="anchor" aria-label="anchor" href="#method"></a>
</h2>
<p>Sed lacinia neque a nisl interdum dictum. Morbi accumsan posuere
mauris. Vivamus vulputate justo sed tincidunt cursus.</p>
</div>
<div class="section level2">
<h2 id="example-a-covid-19-case-study">Example: A COVID-19 case study<a class="anchor" aria-label="anchor" href="#example-a-covid-19-case-study"></a>
</h2>
<p>To determine what factors are highly associated with whether or not
COVID-19 patients are admitted to the ICU, we will perform an analysis
using autoplieR commands.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Bishop-Laboratory/autoplieR" class="external-link">autoplieR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glmnet.stanford.edu" class="external-link">glmnet</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/" class="external-link">caret</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://igordot.github.io/msigdbr/" class="external-link">msigdbr</a></span><span class="op">)</span></span></code></pre></div>
<p>The resulting transformed data can then be used to train a logistic
model for prediction and visualization.</p>
<div class="section level3">
<h3 id="datasets">Datasets<a class="anchor" aria-label="anchor" href="#datasets"></a>
</h3>
<p>Pathways data are obtained from the <code>msigdbr</code> package for
only demonstration. Therefore, <code>misgdbr</code> may not be necessary
for your analysis.</p>
<p>Metadata can also be loaded for easier interpretation of your
results, but is not needed.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load pathways data</span></span>
<span><span class="va">pathways</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://igordot.github.io/msigdbr/reference/msigdbr.html" class="external-link">msigdbr</a></span><span class="op">(</span>category <span class="op">=</span> <span class="st">"H"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">gs_name</span>, <span class="va">gene_symbol</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>value<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        id_cols <span class="op">=</span> <span class="va">gs_name</span>, names_from <span class="op">=</span> <span class="va">gene_symbol</span>,</span>
<span>        values_from <span class="op">=</span> <span class="va">value</span>, values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"gs_name"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get TPM data</span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"GSE157103_icu_metadata.csv.xz"</span>, package <span class="op">=</span> <span class="st">"autoplieR"</span><span class="op">)</span>, </span>
<span>    show_col_types <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>sampleID<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">tpm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"GSE157103_icu_tpm.csv.xz"</span>, package <span class="op">=</span> <span class="st">"autoplieR"</span><span class="op">)</span>, </span>
<span>    show_col_types <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>sampleID<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="training-autoplier">Training autoplieR<a class="anchor" aria-label="anchor" href="#training-autoplier"></a>
</h3>
<p>Once training and pathways files are loaded, we can initiate a model
with the <code><a href="../reference/autoPLIER.html">autoPLIER()</a></code> function. Note that the number of
components (<code>n_components</code>) and learning rate
(<code>learning_rate</code>) chosen here were for quicker illustration
purposes.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a model</span></span>
<span><span class="va">ap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autoPLIER.html">autoPLIER</a></span><span class="op">(</span>n_components <span class="op">=</span> <span class="fl">50</span>, learning_rate <span class="op">=</span> <span class="fl">0.000001</span><span class="op">)</span></span></code></pre></div>
<p>Next, fit and transform the model. It is imperative to assign the fit
step to the same object assigned in the previous build model step.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit model</span></span>
<span><span class="va">ap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autoPLIER.fit.html">autoPLIER.fit</a></span><span class="op">(</span><span class="va">ap</span>, x_train <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="va">tpm</span>, var <span class="op">=</span> <span class="st">"sampleID"</span><span class="op">)</span>, pathways <span class="op">=</span> <span class="va">pathways</span>, verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Transform the new data</span></span>
<span><span class="va">df_ap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autoPLIER.transform.html">autoPLIER.transform</a></span><span class="op">(</span><span class="va">ap</span>, x_predict <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="va">tpm</span>, var <span class="op">=</span> <span class="st">"sampleID"</span><span class="op">)</span>, pathways <span class="op">=</span> <span class="va">pathways</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df_ap</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"LV_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df_ap</span><span class="op">)</span>, pattern <span class="op">=</span> <span class="st">" "</span>, replacement <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The <code>df_ap</code> object can now be used to plot and train a
logistic model.</p>
</div>
<div class="section level3">
<h3 id="plotting-autoplier-transformed-data-using-pca">Plotting autoplieR-transformed data using PCA<a class="anchor" aria-label="anchor" href="#plotting-autoplier-transformed-data-using-pca"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute TSNE</span></span>
<span><span class="va">pca_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="va">df_ap</span>, scale. <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Index and bind metadata for 'COVID' and 'ICU_1'</span></span>
<span><span class="va">df_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">pca_res</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">df_pca</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">df_ap</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_plot</span> <span class="op">&lt;-</span> <span class="va">df_pca</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span>var<span class="op">=</span><span class="st">"sampleID"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">metadata</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        COVID<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">COVID</span><span class="op">)</span>,</span>
<span>        ICU<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">ICU_1</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot for ICU and non-ICU</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">PC1</span>, y <span class="op">=</span> <span class="va">PC2</span>, color <span class="op">=</span> <span class="va">ICU</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Biplot of ICU vs non-ICU"</span><span class="op">)</span></span></code></pre></div>
<img src="autoplieR_files/figure-html/pca_plots-1.png" width="576" style="display: block; margin: auto;"><p>
We see there is separation between ICU and non-ICU COVID patients.
</p>
</div>
<div class="section level3">
<h3 id="training-a-logistic-regression-model-to-predict-icu-vs--non-icu-within-the-covid-19-cohort">Training a logistic regression model to predict ICU vs. non-ICU
within the COVID-19 cohort<a class="anchor" aria-label="anchor" href="#training-a-logistic-regression-model-to-predict-icu-vs--non-icu-within-the-covid-19-cohort"></a>
</h3>
<p>The <code>glmnet</code> package is used to to train a lasso model
with a grid of logarithmic values. Refer to the <code>glmnet</code>
vignette for more details.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit model </span></span>
<span><span class="va">log_lambda_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">20</span>, length<span class="op">=</span><span class="fl">200</span><span class="op">)</span> </span>
<span><span class="va">lambda_grid</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="va">log_lambda_grid</span></span>
<span><span class="va">icu</span> <span class="op">&lt;-</span> <span class="va">metadata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">COVID</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">ICU_1</span><span class="op">)</span></span>
<span><span class="va">lr_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">df_ap</span><span class="op">)</span>, <span class="va">icu</span>, alpha <span class="op">=</span> <span class="fl">1</span>, </span>
<span>    family <span class="op">=</span> <span class="st">"binomial"</span>, type.measure<span class="op">=</span><span class="st">'class'</span>, lambda <span class="op">=</span> <span class="va">lambda_grid</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lr_model</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span>main <span class="op">=</span> <span class="st">"Lasso lamda using 10-fold cross validation"</span>, line <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<img src="autoplieR_files/figure-html/log_mod-1.png" width="576" style="display: block; margin: auto;"><p>
From the plot, we see the misclassification error is the smaller as the
penalty parameter approaches 0. The optimal or minimal lambda is seen at
the left dotted line at approximately -7. The selected lambda below
corresponds with this.
</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select the best lambda</span></span>
<span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="va">lr_model</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">lr_model</span><span class="op">$</span><span class="va">cvm</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>We can now fit the model with the optimal lambda to predict ICU and
non-ICU outcomes in COVID-19 patients.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Build the logistic model</span></span>
<span><span class="va">lr_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glmnet.stanford.edu/reference/glmnet.html" class="external-link">glmnet</a></span><span class="op">(</span></span>
<span>    <span class="va">df_ap</span>, <span class="va">icu</span>, alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    family <span class="op">=</span> <span class="st">"binomial"</span>, type.measure<span class="op">=</span><span class="st">'class'</span>, lambda <span class="op">=</span> <span class="va">lambda</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Once predictions are generated from our trained lasso model,
construct a confusion matrix to examine the distribution of predictions
and actual values.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">lr_final</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">df_ap</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"class"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show the confusion matrix</span></span>
<span><span class="va">pred</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span><span class="st">"sampleID"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>pred_icu<span class="op">=</span><span class="va">s0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>icu<span class="op">=</span><span class="va">icu</span>, pred_icu<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">pred_icu</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">pred_icu</span>, <span class="va">icu</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">tally</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        id_cols <span class="op">=</span> <span class="va">pred_icu</span>, names_from <span class="op">=</span> <span class="va">icu</span>, </span>
<span>        values_from <span class="op">=</span> <span class="va">n</span>, names_prefix <span class="op">=</span> <span class="st">"Real: "</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pred_icu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Predicted: "</span>, <span class="va">pred_icu</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"pred_icu"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##              Real: 0 Real: 1</span></span>
<span><span class="co">## Predicted: 0      46       6</span></span>
<span><span class="co">## Predicted: 1       4      44</span></span></code></pre>
It seems like our predicted and actual values correlate well.
<p>
Lastly, retrieve all non-zero coefficients from the model as shown
below.
</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the coefficients</span></span>
<span><span class="va">coeffs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">lr_final</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Analyze the LVs in the coefs</span></span>
<span><span class="va">coefs_tidy</span> <span class="op">&lt;-</span> <span class="va">coeffs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span><span class="st">"LV"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">s0</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">s0</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span>, <span class="va">LV</span> <span class="op">!=</span> <span class="st">"(Intercept)"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Weight<span class="op">=</span><span class="va">s0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>LV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">LV</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">LV</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span><span class="co"># Plot the LVs and their coefs</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">coefs_tidy</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">LV</span>, y <span class="op">=</span> <span class="va">Weight</span>, fill<span class="op">=</span><span class="va">Weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">.15</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Coefficient weight (association with ICU)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Non-Zero Latent variables (LVs)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"LV weights for prediction of ICU status"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"div"</span>, palette<span class="op">=</span><span class="st">"RdBu"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="autoplieR_files/figure-html/unnamed-chunk-2-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="extracting-lvs-and-top-pathways">Extracting LVs and top pathways<a class="anchor" aria-label="anchor" href="#extracting-lvs-and-top-pathways"></a>
</h3>
<p>Use the obtained coefficients from the previous section above to
select significant LVs. In this example, positive coefficients
corresponded to ICU admission while negative coefficients corresponded
to non-ICU.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve LVs associated with being in the ICU</span></span>
<span><span class="va">top_pos_LVs</span> <span class="op">&lt;-</span> <span class="va">coefs_tidy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_max</a></span><span class="op">(</span>order_by <span class="op">=</span> <span class="va">Weight</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">top_pos_LVs_pwys</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autoPLIER.get_top_pathways.html">autoPLIER.get_top_pathways</a></span><span class="op">(</span><span class="va">ap</span>, LVs <span class="op">=</span> <span class="va">top_pos_LVs</span><span class="op">$</span><span class="va">LV</span>, n_pathways <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">top_pos_LVs_pwys</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">LV</span>, <span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pathway <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">pathway</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">pathway</span><span class="op">)</span><span class="op">)</span>, LV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">LV</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">LV</span>, <span class="va">pathway</span>, size <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"blue"</span>, high <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Pathways corresponding to LVs associated with ICU"</span><span class="op">)</span></span></code></pre></div>
<p><img src="autoplieR_files/figure-html/LVs-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve LVs associated with not being in the ICU</span></span>
<span><span class="va">top_neg_LVs</span> <span class="op">&lt;-</span> <span class="va">coefs_tidy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_min</a></span><span class="op">(</span>order_by <span class="op">=</span> <span class="va">Weight</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">top_neg_LVs_pwys</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autoPLIER.get_top_pathways.html">autoPLIER.get_top_pathways</a></span><span class="op">(</span><span class="va">ap</span>, LVs <span class="op">=</span> <span class="va">top_neg_LVs</span><span class="op">$</span><span class="va">LV</span>, n_pathways <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">top_neg_LVs_pwys</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">LV</span>, <span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pathway <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">pathway</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">pathway</span><span class="op">)</span><span class="op">)</span>, LV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">LV</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">LV</span>, <span class="va">pathway</span>, size <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"blue"</span>, high <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Pathways corresponding to LVs associated with non-ICU"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="autoplieR_files/figure-html/LVs-2.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.2.0 (2022-04-22)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 20.04.4 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0</span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] msigdbr_7.5.1        forcats_0.5.1        stringr_1.4.0       </span></span>
<span><span class="co">##  [4] dplyr_1.0.9          purrr_0.3.4          readr_2.1.2         </span></span>
<span><span class="co">##  [7] tidyr_1.2.0          tibble_3.1.7         tidyverse_1.3.1     </span></span>
<span><span class="co">## [10] caret_6.0-92         lattice_0.20-45      ggplot2_3.3.6       </span></span>
<span><span class="co">## [13] glmnet_4.1-4         Matrix_1.4-1         autoplieR_0.0.0.9000</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] colorspace_2.0-3     ellipsis_0.3.2       class_7.3-20        </span></span>
<span><span class="co">##   [4] rprojroot_2.0.3      fs_1.5.2             rstudioapi_0.13     </span></span>
<span><span class="co">##   [7] farver_2.1.0         listenv_0.8.0        bit64_4.0.5         </span></span>
<span><span class="co">##  [10] prodlim_2019.11.13   fansi_1.0.3          lubridate_1.8.0     </span></span>
<span><span class="co">##  [13] xml2_1.3.3           codetools_0.2-18     splines_4.2.0       </span></span>
<span><span class="co">##  [16] cachem_1.0.6         knitr_1.39           jsonlite_1.8.0      </span></span>
<span><span class="co">##  [19] pROC_1.18.0          broom_0.8.0          dbplyr_2.1.1        </span></span>
<span><span class="co">##  [22] png_0.1-7            compiler_4.2.0       httr_1.4.3          </span></span>
<span><span class="co">##  [25] backports_1.4.1      assertthat_0.2.1     fastmap_1.1.0       </span></span>
<span><span class="co">##  [28] cli_3.3.0            htmltools_0.5.2      tools_4.2.0         </span></span>
<span><span class="co">##  [31] gtable_0.3.0         glue_1.6.2           reshape2_1.4.4      </span></span>
<span><span class="co">##  [34] rappdirs_0.3.3       Rcpp_1.0.8.3         cellranger_1.1.0    </span></span>
<span><span class="co">##  [37] jquerylib_0.1.4      pkgdown_2.0.5        vctrs_0.4.1         </span></span>
<span><span class="co">##  [40] babelgene_22.3       nlme_3.1-157         iterators_1.0.14    </span></span>
<span><span class="co">##  [43] timeDate_3043.102    gower_1.0.0          xfun_0.31           </span></span>
<span><span class="co">##  [46] globals_0.15.0       rvest_1.0.2          lifecycle_1.0.1     </span></span>
<span><span class="co">##  [49] future_1.25.0        MASS_7.3-57          scales_1.2.0        </span></span>
<span><span class="co">##  [52] ipred_0.9-12         vroom_1.5.7          ragg_1.2.2          </span></span>
<span><span class="co">##  [55] hms_1.1.1            parallel_4.2.0       RColorBrewer_1.1-3  </span></span>
<span><span class="co">##  [58] yaml_2.3.5           memoise_2.0.1        reticulate_1.25     </span></span>
<span><span class="co">##  [61] sass_0.4.1           rpart_4.1.16         stringi_1.7.6       </span></span>
<span><span class="co">##  [64] highr_0.9            desc_1.4.1           foreach_1.5.2       </span></span>
<span><span class="co">##  [67] hardhat_0.2.0        lava_1.6.10          shape_1.4.6         </span></span>
<span><span class="co">##  [70] rlang_1.0.2          pkgconfig_2.0.3      systemfonts_1.0.4   </span></span>
<span><span class="co">##  [73] evaluate_0.15        labeling_0.4.2       recipes_0.2.0       </span></span>
<span><span class="co">##  [76] bit_4.0.4            tidyselect_1.1.2     here_1.0.1          </span></span>
<span><span class="co">##  [79] parallelly_1.31.1    plyr_1.8.7           magrittr_2.0.3      </span></span>
<span><span class="co">##  [82] R6_2.5.1             generics_0.1.2       DBI_1.1.2           </span></span>
<span><span class="co">##  [85] pillar_1.7.0         haven_2.5.0          withr_2.5.0         </span></span>
<span><span class="co">##  [88] survival_3.2-13      nnet_7.3-17          future.apply_1.9.0  </span></span>
<span><span class="co">##  [91] modelr_0.1.8         crayon_1.5.1         utf8_1.2.2          </span></span>
<span><span class="co">##  [94] tzdb_0.3.0           rmarkdown_2.14       grid_4.2.0          </span></span>
<span><span class="co">##  [97] readxl_1.4.0         data.table_1.14.2    ModelMetrics_1.2.2.2</span></span>
<span><span class="co">## [100] reprex_2.0.1         digest_0.6.29        textshaping_0.3.6   </span></span>
<span><span class="co">## [103] stats4_4.2.0         munsell_0.5.0        bslib_0.3.1</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by First Last.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
